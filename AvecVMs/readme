README - Script update-proxmox_VMs.sh
=====================================

üìã Description
--------------
Ce script Bash permet de mettre √† jour automatiquement :
- Le n≈ìud Proxmox VE
- Les conteneurs LXC (sauf ceux explicitement ignor√©s)
- Les machines virtuelles (VMs) via SSH

Il g√©n√®re un rapport de mise √† jour, l‚Äôenvoie par email avec les logs en pi√®ce jointe, et envoie √©galement une notification Telegram.

‚öôÔ∏è Pr√©requis
------------
- Proxmox VE avec acc√®s root
- Outils install√©s :
  - mailx
  - curl
  - sshpass
  - jq
- Acc√®s SSH root aux VMs
- Un bot Telegram configur√©
- Un compte email SMTP (ex : Gmail)

üßæ Installation
---------------
1. Copier le script dans `/usr/local/bin/update-proxmox_VMs.sh`
2. Rendre le script ex√©cutable :
   chmod +x /usr/local/bin/update-proxmox_VMs.sh
3. Adapter les variables de configuration en haut du script :
   - ROOT_USER, ROOT_PASS
   - SMTP_* pour l‚Äôenvoi d‚Äôemail
   - TELEGRAM_TOKEN, TELEGRAM_CHAT_ID
   - IGNORED_CONTAINERS pour exclure certains CTs

üöÄ Utilisation
--------------
Ex√©cuter le script avec les droits root :
sudo /usr/local/bin/update-proxmox_VMs.sh

üì¶ Fonctionnalit√©s
------------------
- Mise √† jour du syst√®me h√¥te (apt update && upgrade)
- Mise √† jour des conteneurs LXC actifs
- Mise √† jour des VMs via SSH (si IP d√©tect√©e et port SSH ouvert)
- Envoi d‚Äôun email avec le r√©sum√© et les logs
- Notification Telegram avec le r√©sum√©
- Rotation automatique des logs (suppression apr√®s 7 jours)

üìÅ Logs
-------
- Les logs sont stock√©s dans : /var/log/proxmox-update/update.log
- Les anciens logs sont archiv√©s dans : /var/log/proxmox-update/archive/

üõ°Ô∏è S√©curit√©
-----------
- Le mot de passe root est stock√© en clair dans le script. Il est fortement recommand√© d‚Äôutiliser une m√©thode plus s√©curis√©e (cl√© SSH, vault, etc.) en production.
